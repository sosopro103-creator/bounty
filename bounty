repeat task.wait() until game:IsLoaded()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- SETTINGS
local Enabled = false
local LockDistance = 500
local AimPart = "HumanoidRootPart" -- or "Head"
local Smoothness = 0.15

-- GUI
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "AimLockGui"
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.fromScale(0.18, 0.08)
frame.Position = UDim2.fromScale(0.05, 0.25)
frame.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true

Instance.new("UICorner", frame).CornerRadius = UDim.new(0.25,0)

local label = Instance.new("TextLabel", frame)
label.Size = UDim2.fromScale(1,1)
label.BackgroundTransparency = 1
label.Text = "AIM: OFF"
label.Font = Enum.Font.GothamBold
label.TextScaled = true
label.TextColor3 = Color3.new(1,1,1)

-- Toggle
frame.InputBegan:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.Touch then
        Enabled = not Enabled
        if Enabled then
            frame.BackgroundColor3 = Color3.fromRGB(0,170,0)
            label.Text = "AIM: ON"
        else
            frame.BackgroundColor3 = Color3.fromRGB(200,0,0)
            label.Text = "AIM: OFF"
        end
    end
end)

-- Get closest player to center
local function getTarget()
    local closest, dist = nil, math.huge
    local camPos = Camera.CFrame.Position

    for _,plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character then
            local part = plr.Character:FindFirstChild(AimPart)
            local hum = plr.Character:FindFirstChild("Humanoid")
            if part and hum and hum.Health > 0 then
                local d = (part.Position - camPos).Magnitude
                if d < LockDistance and d < dist then
                    dist = d
                    closest = part
                end
            end
        end
    end

    return closest
end

-- Aim lock loop
RunService.RenderStepped:Connect(function()
    if not Enabled then return end

    local target = getTarget()
    if target then
        local camCF = Camera.CFrame
        local targetCF = CFrame.new(camCF.Position, target.Position)
        Camera.CFrame = camCF:Lerp(targetCF, Smoothness)
    end
end)
